(self.webpackChunkbav4=self.webpackChunkbav4||[]).push([[415],{146:(t,e,i)=>{var a=i(8081),r=i(3645),n=i(1667),s=i(2933),o=i(1077),l=i(5534),c=i(5360),d=i(6077),h=i(9346),_=r(a),u=n(s),g=n(o),p=n(l),v=n(c),f=n(d),m=n(h);_.push([t.id,`.profile.is-portrait {\n\theight: 20em;\n}\n.profile.is-landscape {\n\theight: 15em;\n}\n.is-portrait .chart-container {\n\tposition: relative;\n\theight: 14em;\n\twidth: 100%;\n\tdisplay: inline-block;\n}\n.is-landscape .chart-container {\n\tposition: relative;\n\theight: 14em;\n\twidth: 89%;\n\tdisplay: inline-block;\n}\n.is-portrait .profile__data {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\twidth: 100%;\n\tposition: relative;\n}\n.is-landscape .profile__data {\n\talign-items: center;\n\tjustify-content: space-between;\n\tdisplay: inline-block;\n\twidth: 11%;\n\tposition: relative;\n\tfloat: right;\n}\n.profile__options {\n\twidth: 7em;\n\tdisplay: block;\n}\n.profile__box:first-child {\n\tborder-left: 0;\n}\n.is-portrait .profile__box {\n\theight: 4em;\n\tdisplay: flex;\n\tflex-direction: column;\n\tborder-left: 1px dotted var(--header-background-color);\n\twidth: 100%;\n}\n.is-landscape .profile__box {\n\theight: 4em;\n\tdisplay: flex;\n\tflex-direction: column;\n\tborder-left: 1px dotted var(--header-background-color);\n\twidth: 50%;\n\tfloat: left;\n}\n.profile__text {\n\tfont-weight: bold;\n\ttext-align: center;\n\tmargin: 0;\n\tfont-size: 0.9rem;\n\tcolor: var(--text1);\n}\n.is-tablet .profile__text {\n\tfont-size: 0.8rem;\n}\n.is-portrait.is-tablet .profile__text {\n\tfont-size: 1rem;\n}\n.highest {\n\tmask: url(${u});\n\t-webkit-mask: url(${u});\n}\n.lowest {\n\tmask: url(${g});\n\t-webkit-mask: url(${g});\n}\n.up {\n\tmask: url(${p});\n\t-webkit-mask: url(${v});\n}\n.down {\n\tmask: url(${p});\n\t-webkit-mask: url(${p});\n}\n.height {\n\tmask: url(${f});\n\t-webkit-mask: url(${f});\n}\n.distance {\n\tmask: url(${m});\n\t-webkit-mask: url(${m});\n}\n.profile__icon {\n\theight: 2em;\n\tmin-width: 2em;\n\tbackground: var(--primary-color);\n\tdisplay: block;\n\tmargin: auto;\n\tmask-size: cover;\n\t-webkit-mask-size: cover;\n}\n.is-tablet .profile__icon {\n\theight: 1.5em;\n\tmin-width: 1.5em;\n}\n.is-portrait.is-tablet .profile__icon {\n\theight: 2em;\n\tmin-width: 2em;\n}\n`,""]),t.exports=_},8326:(t,e,i)=>{var a=i(146);a&&a.__esModule&&(a=a.default),t.exports="string"==typeof a?a:a.toString()},6687:(t,e,i)=>{"use strict";i.r(e);var a=i(3692),r=i(8326),n=i.n(r),s=i(4304),o=i(5261),l=i(540);class c{constructor(t,e,i,a=null){this._attribute=t,this._name=e,this._lightColor=i,this._darkColor=null===a?i:a;const{TranslationService:r,StoreService:n}=l.U.inject("TranslationService","StoreService");this._translationService=r,this._storeService=n}get caption(){return(t=>this._translationService.translate(t))("elevationProfile_"+this._attribute)}get name(){return this._name}get color(){const{media:{darkSchema:t}}=this._storeService.getStore().getState();return t?this._darkColor:this._lightColor}}class d extends c{constructor(t,e,i){super("surface",t,e,i)}}var h=i(9563),_=i(5797),u=i(804);const g="update_schema",p="update_selected_attribute",v="update_profile_data",f="update_media",m=Object.freeze({FLAT:"flat",GENTLY_UNDULATING:"gentlyUndulating",UNDULATING:"undulating",ROLLING:"rolling",MODERATELY_STEEP:"moderatelySteep",STEEP:"steep"}),b=Object.freeze([{type:m.FLAT,min:0,max:2,color:"#1f8a70"},{type:m.GENTLY_UNDULATING,min:2,max:5,color:"#bedb39"},{type:m.UNDULATING,min:5,max:8,color:"#ffd10f"},{type:m.ROLLING,min:8,max:15,color:"#fd7400"},{type:m.MODERATELY_STEEP,min:15,max:30,color:"#d23600"},{type:m.STEEP,min:30,max:1/0,color:"#691b00"}]),D="alt",T=Object.freeze({labels:[],chartData:[],elevations:[],attrs:[],distUnit:"m",stats:{sumUp:0,sumDown:0,verticalHeight:0,highestPoint:0,lowestPoint:0,linearDistance:0}});class L extends s.T{constructor(){super({profile:T,labels:null,data:null,selectedAttribute:D,darkSchema:null,distUnit:null,portrait:!1,minWidth:!1}),this._chart=null,this._elevationProfileAttributeTypes=[];const{ConfigService:t,ElevationService:e,TranslationService:i,UnitsService:a}=l.U.inject("ConfigService","ElevationService","TranslationService","UnitsService");this._translationService=i,this._configService=t,this._elevationService=e,this._unitsService=a,this._drawSelectedAreaBorder=!1,this._mouseIsDown=!1,this._firstLeft=0,this._secondLeft=0,this._top=0,this._bottom=0,this._noAnimationValue=!1,this._unsubscribers=[],this._initSurfaceTypes()}onInitialize(){this.style.width="100%",this._unsubscribers=[this.observe((t=>t.media.darkSchema),(t=>this.signal(g,t))),this.observe((t=>t.elevationProfile.coordinates),(t=>this._getElevationProfile(t))),this.observe((t=>t.media),(t=>this.signal(f,t)),!0)]}update(t,e,i){switch(t){case v:return{...i,profile:e,labels:e.labels,data:e.chartData,distUnit:e.distUnit};case g:return{...i,darkSchema:e};case p:return{...i,selectedAttribute:e};case f:return{...i,portrait:e.portrait,minWidth:e.minWidth}}}onAfterRender(){this._updateOrCreateChart()}onDisconnect(){for(this._destroyChart(),(0,h.g)(L.HIGHLIGHT_FEATURE_ID);this._unsubscribers.length>0;)this._unsubscribers.shift()()}createView(t){const{portrait:e,minWidth:i,profile:{attrs:r}}=t,s=t=>this._translationService.translate(t),o=t.profile?.stats?.sumUp,l=t.profile?.stats?.sumDown,c=t.profile?.stats?.verticalHeight,d=t.profile?.stats?.highestPoint,h=t.profile?.stats?.lowestPoint,_=t.profile?.stats?.linearDistance;return a.dy`
			<style>
				${n()}
			</style>
			<div class="profile ${e?"is-portrait":"is-landscape"} ${i?"is-desktop":"is-tablet"}">
				<span class="profile__options">
					<select id="attrs" @change=${()=>{this._noAnimation=!0;const t=this.shadowRoot.getElementById("attrs"),e=t.options[t.selectedIndex].value;this.signal(p,e)}}>
						${r.map((e=>a.dy`
								<option value="${e.id}" ?selected=${t.selectedAttribute===e.id}>${s("elevationProfile_"+e.id)}</option>
							`))}
					</select>
				</span>
				<div class="chart-container" style="">
					<canvas class="elevationprofile" id="route-elevation-chart"></canvas>
				</div>
				<div class="profile__data" id="route-elevation-chart-footer">
					<div class="profile__box" title="${s("elevationProfile_sumUp")}">
						<div class="profile__icon up"></div>
						<div class="profile__text" id="route-elevation-chart-footer-sumUp">${(0,u.HA)(o)} m</div>
					</div>
					<div class="profile__box" title="${s("elevationProfile_sumDown")}">
						<div class="profile__icon down"></div>
						<div class="profile__text" id="route-elevation-chart-footer-sumDown">${(0,u.HA)(l)} m</div>
					</div>
					<div class="profile__box" title="${s("elevationProfile_highestPoint")}">
						<div class="profile__icon highest"></div>
						<div class="profile__text" id="route-elevation-chart-footer-highestPoint">${(0,u.HA)(d)} m</div>
					</div>
					<div class="profile__box" title="${s("elevationProfile_lowestPoint")}">
						<div class="profile__icon lowest"></div>
						<div class="profile__text" id="route-elevation-chart-footer-lowestPoint">${(0,u.HA)(h)} m</div>
					</div>
					<div class="profile__box" title="${s("elevationProfile_verticalHeight")}">
						<div class="profile__icon height"></div>
						<div class="profile__text" id="route-elevation-chart-footer-verticalHeight">${(0,u.HA)(c)} m</div>
					</div>
					<div class="profile__box" title="${s("elevationProfile_linearDistance")}">
						<div class="profile__icon distance"></div>
						<div class="profile__text" id="route-elevation-chart-footer-linearDistance">${this._unitsService.formatDistance(_)}</div>
					</div>
				</div>
			</div>
		`}get _noAnimation(){return this._noAnimationValue}set _noAnimation(t){this._noAnimationValue=t}_enrichAltsArrayWithAttributeData(t,e){const i=t.id;t.values.forEach((t=>{for(let a=t[0];a<=t[1];a++)e.elevations[a][i]=t[2]}))}_enrichProfileData(t){void 0===t.refSystem&&(t.refSystem=(t=>this._translationService.translate(t))("elevationProfile_unknown")),t.distUnit=this._getDistUnit(t);const e=[];t.elevations.forEach((i=>{"km"===t.distUnit?e.push(i.dist/1e3):e.push(i.dist),i.alt=i.z})),t.labels=e,t.chartData=t.elevations.map((t=>t.z)),t.attrs.forEach((e=>{this._enrichAltsArrayWithAttributeData(e,t)})),t.attrs=[{id:"alt"},...t.attrs];const i=this.getModel().selectedAttribute;t.attrs.find((t=>t.id===i))||this.signal(p,D)}_getDistUnit(t){const e=t.elevations[0].dist,i=t.elevations[t.elevations.length-1].dist;return this._unitsService.formatDistance(i-e).includes("km")?"km":"m"}_getChartData(t,e,i){return{labels:e,datasets:[{data:i,label:(t=>this._translationService.translate("elevationProfile_elevation_profile"))(),fill:!0,borderWidth:4,backgroundColor:e=>this._getBackground(e.chart,t),borderColor:e=>this._getBorder(e.chart,t),tension:.1,pointRadius:0,spanGaps:!0,maintainAspectRatio:!1}]}}_getBackground(t,e){if(t.chartArea){const i=this.getModel().selectedAttribute;return"surface"===i?this._getTextTypeGradient(t,e,i):L.BACKGROUND_COLOR}return L.BACKGROUND_COLOR}_getBorder(t,e){if(t.chartArea){const i=this.getModel().selectedAttribute;switch(i){case"slope":return this._getSlopeGradient(t,e);case"surface":return this._getTextTypeGradient(t,e,i);default:return L.BORDER_COLOR}}return L.BORDER_COLOR}_addAttributeType(t){this._elevationProfileAttributeTypes[t._attribute]||(this._elevationProfileAttributeTypes[t._attribute]=[]),this._elevationProfileAttributeTypes[t._attribute].push(t)}_getElevationProfileAttributeType(t,e){return this._elevationProfileAttributeTypes[t].find((t=>t._name===e))}_initSurfaceTypes(){this._addAttributeType(new d("asphalt","#222222","#444444")),this._addAttributeType(new d("gravel","#eeeeee","#dddddd")),this._addAttributeType(new d("missing","#2222ee","#ee2222"))}_getTextTypeGradient(t,e,i){const{ctx:a,chartArea:r}=t,n=a.createLinearGradient(r.left,0,r.right,0),s=e.elevations.length,o=r.width/s,l=e.elevations[0][i];let c,d=this._getElevationProfileAttributeType(i,l);return n.addColorStop(0,d.color),e.elevations.forEach(((t,a)=>{if(0===a)return;if(a===e.elevations.length-1){const t=o/r.width*a;return void n.addColorStop(t,d.color)}const s=t[i];if(c=this._getElevationProfileAttributeType(i,s),d===c)return;const l=o/r.width*a;n.addColorStop(l,d.color),d=c,n.addColorStop(l,d.color)})),n}_getSlopeGradient(t,e){const{ctx:i,chartArea:a}=t,r=i.createLinearGradient(a.left,0,a.right,0),n=e.elevations.length,s=a.width/n;return e?.elevations.forEach(((t,e)=>{if(t.slope){const i=s/a.width*e,n=Math.abs(t.slope),o=b.find((t=>t.min<=n&&t.max>n));r.addColorStop(i,o.color)}})),r}async _getElevationProfile(t){const e=t=>this._translationService.translate(t);if(Array.isArray(t)&&t.length>=2)try{const e=await this._elevationService.getProfile(t);e?(this._enrichProfileData(e),this.signal(v,e)):this.signal(v,T)}catch(t){console.error(t),(0,_.z)(e("elevationProfile_could_not_load"),_.T.ERROR),this.signal(v,T)}else this.signal(v,T)}_getChartConfig(t,e,i,a){const r=this,n=t=>this._translationService.translate(t),s=e=>{const i=t.labels.indexOf(e.parsed.x);return t.elevations[i]},o=t=>"string"==typeof t?parseFloat(t.replace(",",".")):t;return{type:"line",data:this._getChartData(t,e,i),plugins:[{afterRender(){r.dispatchEvent(new CustomEvent("chartJsAfterRender",{bubbles:!0}))}},{id:"terminateHighlightFeatures",beforeEvent(t,e){e?.event?.native&&["mouseout","pointerup"].includes(e.event.native.type)&&(0,h.g)(L.HIGHLIGHT_FEATURE_ID)}},{id:"shortenLeftEndOfScale",beforeInit:t=>{t.options.scales.x.min=Math.min(...t.data.labels),t.options.scales.x.max=Math.max(...t.data.labels)}},{id:"drawVerticalLineAtMousePosition",afterTooltipDraw(t,e){const i=e.tooltip.caretX,{scales:a,ctx:r}=t,n=a.y;r.beginPath(),t.ctx.moveTo(i,n.getPixelForValue(n.max,0)),t.ctx.strokeStyle="#ff0000",t.ctx.lineTo(i,n.getPixelForValue(n.min,0)),t.ctx.stroke()}}],options:{responsive:!0,animation:{duration:this._noAnimation?0:600,delay:this._noAnimation?0:300},maintainAspectRatio:!1,scales:{x:{type:"linear",title:{display:!0,text:n("elevationProfile_distance")+" ["+a+"]",color:L.DEFAULT_TEXT_COLOR},ticks:{color:L.DEFAULT_TEXT_COLOR}},y:{type:"linear",beginAtZero:!1,title:{display:!0,text:n("elevationProfile_alt")+" [m]",color:L.DEFAULT_TEXT_COLOR},ticks:{color:L.DEFAULT_TEXT_COLOR}}},events:["pointermove","pointerup","mouseout"],plugins:{title:{align:"end",display:!0,text:t.refSystem,color:L.DEFAULT_TEXT_COLOR},legend:{display:!1},tooltip:{displayColors:!1,mode:"index",intersect:!1,callbacks:{title:t=>{const e=t[0],i=s(e);this.setCoordinates([i.e,i.n]);const r="km"===a?1e3*o(e.label):o(e.label),l=this._unitsService.formatDistance(r);return n("elevationProfile_distance")+": "+l},label:e=>{const i=[],a=this.getModel().selectedAttribute,r=s(e);let o=r[a],l=n("elevationProfile_"+a)+": ";const c=t.attrs.find((t=>t.id===a));if("string"!=typeof o&&(o=(0,u.HA)(o)),c.prefix?l+=c.prefix+" "+o:l+=o,a===D)return l+=" m",l;{const t=n("elevationProfile_"+D)+": "+r[D]+" m";i.push(t)}return c.unit&&(l+=" "+c.unit),i.push(l),i}}}}}}}setCoordinates(t){(0,h.g)(L.HIGHLIGHT_FEATURE_ID),(0,h.Lq)({id:L.HIGHLIGHT_FEATURE_ID,type:h.c1.TEMPORARY,data:{coordinate:[...t]}})}_createChart(t,e,i,a){const r=this.shadowRoot.querySelector(".elevationprofile").getContext("2d");this._chart=new o.ZP(r,this._getChartConfig(t,e,i,a)),this._noAnimation=!1}_destroyChart(){this._chart&&(this._chart.clear(),this._chart.destroy(),delete this._chart)}_updateOrCreateChart(){const{profile:t,labels:e,data:i,distUnit:a}=this.getModel();this._destroyChart(),this._createChart(t,e,i,a)}static get IS_DARK(){const{StoreService:t}=l.U.inject("StoreService"),{media:{darkSchema:e}}=t.getStore().getState();return e}static get DEFAULT_TEXT_COLOR_DARK(){return"rgb(240, 243, 244)"}static get DEFAULT_TEXT_COLOR_LIGHT(){return"rgb(92, 106, 112)"}static get DEFAULT_TEXT_COLOR(){return L.IS_DARK?L.DEFAULT_TEXT_COLOR_DARK:L.DEFAULT_TEXT_COLOR_LIGHT}static get BACKGROUND_COLOR_DARK(){return"rgb(38, 74, 89)"}static get BACKGROUND_COLOR_LIGHT(){return"#e3eef4"}static get BACKGROUND_COLOR(){return L.IS_DARK?L.BACKGROUND_COLOR_DARK:L.BACKGROUND_COLOR_LIGHT}static get BORDER_COLOR_DARK(){return"rgb(9, 157, 220)"}static get BORDER_COLOR_LIGHT(){return"#2c5a93"}static get BORDER_COLOR(){return L.IS_DARK?L.BORDER_COLOR_DARK:L.BORDER_COLOR_LIGHT}static get HIGHLIGHT_FEATURE_ID(){return"#elevationProfileHighlightFeatureId"}static get tag(){return"ba-elevation-profile"}}window.customElements.get(L.tag)||window.customElements.define(L.tag,L)},5534:t=>{"use strict";t.exports="data:image/svg+xml;base64,CjxzdmcgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDI0IiBoZWlnaHQ9IjEwMjQiIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjwhLS0gTUlUIExpY2Vuc2UgLS0+CjxnIGlkPSJpY29tb29uLWlnbm9yZSI+CjwvZz4KPHBhdGggZmlsbD0iIzAwMCIgZD0iTTE0NS4wNjcgMjE1LjQ2N2w3MS40NjctNzAuNCA1MTIgNTEydi0yODYuOTMzaDEwMC4yNjd2NDU4LjY2N2gtNDU4LjY2N3YtMTAwLjI2N2gyODh6Ij48L3BhdGg+Cjwvc3ZnPg=="},6077:t=>{"use strict";t.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iNDgiIHdpZHRoPSI0OCI+PHBhdGggZD0ibTI0IDQyLjctOS05IDIuOS0yLjkgNC4xIDQuMTV2LTIxLjlsLTQuMSA0LjE1LTIuOS0yLjkgOS05IDkgOS0yLjkgMi45LTQuMS00LjE1djIxLjlsNC4xLTQuMTUgMi45IDIuOVoiLz48L3N2Zz48IS0tIE1JVCBMaWNlbnNlIC0tPg=="},9346:t=>{"use strict";t.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMjQiIGhlaWdodD0iMTAyNCIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCI+PCEtLSBNSVQgTGljZW5zZSAtLT4KPHRpdGxlPjwvdGl0bGU+CjxnIGlkPSJpY29tb29uLWlnbm9yZSI+CjwvZz4KPHBhdGggZmlsbD0iIzAwMCIgZD0iTTExMy4wNjcgNTEybDE5Mi0xOTIgNjEuODY3IDYxLjg2Ny04OC41MzMgODcuNDY3aDQ2Ny4ybC04OC41MzMtODcuNDY3IDYxLjg2Ny02MS44NjcgMTkyIDE5Mi0xOTIgMTkyLTYxLjg2Ny02MS44NjcgODguNTMzLTg3LjQ2N2gtNDY3LjJsODguNTMzIDg3LjQ2Ny02MS44NjcgNjEuODY3eiI+PC9wYXRoPgo8L3N2Zz4="},5360:t=>{"use strict";t.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iNDgiIHdpZHRoPSI0OCI+PHBhdGggZD0ibTEwLjEgNDAuNy0yLjgtMi44NUwzMS43IDEzLjVoLTE0di00aDIwLjh2MjAuOGgtNFYxNi4yNVoiLz48L3N2Zz48IS0tIE1JVCBMaWNlbnNlIC0tPg=="},1077:t=>{"use strict";t.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iNDgiIHdpZHRoPSI0OCI+PHBhdGggZD0iTTI0IDMxLjUgMTEuMyAxOC44bDIuODUtMi44NUwyNCAyNS44bDkuODUtOS44NSAyLjg1IDIuODVaIi8+PC9zdmc+PCEtLSBNSVQgTGljZW5zZSAtLT4="},2933:t=>{"use strict";t.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iNDgiIHdpZHRoPSI0OCI+PHBhdGggZD0ibTE0LjE1IDMxLjQtMi44NS0yLjg1TDI0IDE1LjlsMTIuNyAxMi42LTIuODUgMi44NUwyNCAyMS41WiIvPjwvc3ZnPjwhLS0gTUlUIExpY2Vuc2UgLS0+"}}]);